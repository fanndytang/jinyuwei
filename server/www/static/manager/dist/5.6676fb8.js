webpackJsonp([5],{421:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r(457),a=r.n(l),o=r(440),i=r(55),n=i(a.a,o.a,null,null,null);t.default=n.exports},440:function(e,t,r){"use strict";var l=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("广告管理")]),e._v(" "),e.isAdd?e._e():r("el-button",{staticStyle:{margin:"20px 0"},on:{click:function(t){e.isAdd=!0}}},[e._v("添加")]),e._v(" "),e.isAdd?e._e():r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[r("el-table-column",{attrs:{prop:"group",label:"所属组",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"link",label:"链接",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"target",label:"是否新窗口"}}),e._v(" "),r("el-table-column",{attrs:{prop:"sort",label:"序号"}}),e._v(" "),r("el-table-column",{attrs:{prop:"content",label:"描述"}}),e._v(" "),r("el-table-column",{attrs:{prop:"image",label:"广告图"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.updateAdvert(e.list[t.$index]._id,t.$index)}}},[e._v("修改")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){e.deleteAdvert(e.list[t.$index]._id,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),e.isAdd?r("el-form",{ref:"form",staticStyle:{width:"80%"},attrs:{rules:e.rules,model:e.ruleForm,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"所属组",prop:"group"}},[r("el-input",{model:{value:e.ruleForm.group,callback:function(t){e.ruleForm.group=t},expression:"ruleForm.group"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"链接",prop:"link"}},[r("el-input",{model:{value:e.ruleForm.link,callback:function(t){e.ruleForm.link=t},expression:"ruleForm.link"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"是否新窗口"}},[r("el-radio-group",{model:{value:e.ruleForm.target,callback:function(t){e.ruleForm.target=t},expression:"ruleForm.target"}},[r("el-radio",{attrs:{label:"是"}}),e._v(" "),r("el-radio",{attrs:{label:"否"}})],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"序号",prop:"sort"}},[r("el-input",{model:{value:e.ruleForm.sort,callback:function(t){e.ruleForm.sort=t},expression:"ruleForm.sort"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述",prop:"content"}},[r("el-input",{model:{value:e.ruleForm.content,callback:function(t){e.ruleForm.content=t},expression:"ruleForm.content"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"广告图"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://127.0.0.1:8360/api/upload/image","show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.ruleForm.images?r("img",{staticClass:"avatar",attrs:{src:e.ruleForm.images}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.ruleForm.imagesid,expression:"ruleForm.imagesid"}],attrs:{type:"hidden"},domProps:{value:e.ruleForm.imagesid},on:{input:function(t){t.target.composing||(e.ruleForm.imagesid=t.target.value)}}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addAdvert("form")}}},[e._v("确定")]),e._v(" "),r("el-button",{on:{click:function(t){e.resetForm("form")}}},[e._v("重置")])],1)],1):e._e()],1)},a=[];t.a={render:l,staticRenderFns:a}},457:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r(148),a=function(e){return e&&e.__esModule?e:{default:e}}(l);t.default={data:function(){return{list:[],isAdd:!1,ruleForm:{group:"",link:"",target:"是",sort:"",images:"",imagesid:"",content:""},rules:{group:[{required:!0,message:"",trigger:"blur"}],link:[{required:!0,message:"",trigger:"blur"}],target:[{required:!0,message:"",trigger:"blur"}],sort:[{required:!0,message:"",trigger:"blur"}],content:[{required:!0,message:"",trigger:"blur"}]}}},layout:"admin",mounted:function(){this.getAdvert()},methods:{getAdvert:function(){var e=this;e.$http.get("/api/advert/list").then(function(t){e.list=JSON.parse(t.request.response).data.sort(a.default.compare("sort"))})},deleteAdvert:function(e,t){var r=this;r.$http.post("/api/advert/delete",{id:e}).then(function(e){r.list.splice(t,1)})},updateAdvert:function(e,t){var r=this;r.$http.post("/api/advert/update",{id:e,group:r.ruleForm.group,link:r.ruleForm.link,sort:r.ruleForm.sort,content:r.ruleForm.content,target:r.ruleForm.target,imagesid:r.ruleForm.imagesid}).then(function(e){r.list.splice(t,1,JSON.parse(e.request.response).data)})},addAdvert:function(e){var t=this;t.$http.post("/api/advert/add",{group:t.ruleForm.group,link:t.ruleForm.link,sort:t.ruleForm.sort,content:t.ruleForm.content,target:t.ruleForm.target,imagesid:t.ruleForm.imagesid}).then(function(e){window.location.reload()})},handleAvatarSuccess:function(e,t){this.ruleForm.images=URL.createObjectURL(t.raw),this.ruleForm.imagesid=e.data.data.file._id},beforeAvatarUpload:function(e){var t="image/jpeg"===e.type,r="image/png"===e.type,l="image/gif"===e.type,a=e.size/1024/1024<2;return t||r||l||this.$message.error("上传图片格式只允许jpg, png, gif"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&a}}}}});
//# sourceMappingURL=5.6676fb8.js.map